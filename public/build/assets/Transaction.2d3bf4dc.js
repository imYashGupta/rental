import{r as p,j as s,a as e,F as x,u as E,c as D,R as C,H as V}from"./app.40c721d9.js";import{C as q,A as M,H as B}from"./Header.6c513327.js";import{P as S}from"./PrimaryButton.648f8a5f.js";import{T as H,I as L}from"./TextInput.e39c3660.js";import{I as U}from"./InputLabel.bc5c373a.js";import{W as N}from"./transition.330bc84b.js";import{g as I}from"./dialog.6390d555.js";import"./XMarkIcon.fca00a69.js";function z({title:n,titleId:r,...t},o){return s("svg",{...Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":r},t),children:[n?e("title",{id:r,children:n}):null,e("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z",clipRule:"evenodd"})]})}const P=p.exports.forwardRef(z),$=P,u=n=>{const{label:r,name:t,type:o,value:f,onHandleChange:b,errors:g,labelClass:v,InputClass:a,ErrorClass:h}=n;return s(x,{children:[e(U,{forInput:t,ty:!0,value:r}),e(H,{type:o||"text",name:t,value:f,className:"mt-1 block  "+a+(g.name?" border-red-500":" "),handleChange:b,...n}),e(L,{message:g.name,className:"mt-2"})]})};function G({electricityModal:n,setElectricityModal:r,setRoomData:t,setRoom:o,roomData:f,room:b,setShowNotification:g}){console.log(f);const[v,a]=p.exports.useState(n);p.exports.useEffect(()=>{a(!!n)},[n]);const h=p.exports.useRef(null),_=()=>{console.log("Model Close"),a(!1),r(!1)},{data:w,setData:c,post:F,processing:j,errors:R,transform:m,reset:k,clearErrors:T}=E({units:""}),i=l=>{c(l.target.name,l.target.type==="checkbox"?l.target.checked:l.target.value)},d=l=>{l.preventDefault(),console.log("pk"),D.post(route("resetElectricity",b.id),{units:w.units}).then(y=>{t({...f,electricity_units:w.units}),o(y.data.room),r(!1),g(!0)}).catch(y=>{console.log(y)})};return e(N.Root,{show:v,as:p.exports.Fragment,children:s(I,{as:"div",className:"relative z-10",initialFocus:h,onClose:_,children:[e(N.Child,{as:p.exports.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),e("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e("div",{className:"flex min-h-full items-end justify-center  text-center sm:items-center sm:p-0 ",children:e(N.Child,{as:p.exports.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:s(I.Panel,{className:"relative transform overflow-hidden bg-white text-left shadow-xl transition-all sm:my-8 w-full max-w-7xl",children:[e("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 ",children:e("div",{className:"sm:flex sm:items-start",children:e("div",{className:"py-4",children:e(I.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"Reset Electricity Meter Units"})})})}),s("form",{onSubmit:d,children:[e("div",{className:"bg-white px-4 py-5 border-b border-gray-200 sm:px-6 text-center border-t flex justify-center items-center",children:e(u,{type:"text",required:!0,label:"Units",InputClass:"w-full ml-2",name:"units",value:w.units,onHandleChange:i,errors:R})}),e("div",{className:"bg-gray-50 px-4 py-3 sm:flex text-right  sm:px-6",children:e(S,{type:"submit",children:"Reset"})})]})]})})})})]})})}function O({heading:n,message:r,showNotification:t,setShowNotification:o}){return p.exports.useState(t),e(x,{children:e("div",{"aria-live":"assertive",className:"fixed inset-0 flex items-end px-4 py-6 pointer-events-none sm:p-6 sm:items-start",children:e("div",{className:"w-full flex flex-col items-center space-y-4 sm:items-end",children:e(N,{show:t,as:p.exports.Fragment,enter:"transform ease-out duration-300 transition",enterFrom:"translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2",enterTo:"translate-y-0 opacity-100 sm:translate-x-0",leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"max-w-sm w-full bg-white shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden",children:e("div",{className:"p-4",children:s("div",{className:"flex items-start",children:[e("div",{className:"flex-shrink-0",children:e(q,{className:"h-6 w-6 text-green-400","aria-hidden":"true"})}),s("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:[e("p",{className:"text-sm font-medium text-gray-900",children:n}),e("p",{className:"mt-1 text-sm text-gray-500",children:r})]}),e("div",{className:"ml-4 flex-shrink-0 flex",children:s("button",{className:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:()=>{o(!1)},children:[e("span",{className:"sr-only",children:"Close"}),e($,{className:"h-5 w-5","aria-hidden":"true"})]})})]})})})})})})})}function A({room:n,type:r}){const[t,o]=C.useState(n),[f,b]=C.useState(!1),[g,v]=C.useState(!1),{data:a,setData:h,post:_,processing:w,errors:c,transform:F,reset:j,clearErrors:R}=E({name:"",email:"",phone:"",date:r!="ADVANCE"?t.next_month._date.toString().substr(0,10):"",remark:"",electricity_units:t.initial_electricity_units,electricity_consumed:0,recurring_charges:t.recurring_charges,rent:r=="VACANT"?0:t.rental,total:t.recurring_charges+(r=="VACANT"?0:t.rental),type:r,balance:t.balance,amount_collected:t.balance+t.recurring_charges+(r=="VACANT"?0:t.rental)}),m=i=>{let d=isNaN(parseInt(i.target.value))?0:parseInt(i.target.value);if(i.target.name=="electricity_units"){let l=i.target.value-t.initial_electricity_units,y=a.recurring_charges+a.rent+(isNaN(l)?0:l)*parseInt(t.electricity_unit_rate);h({...a,total:y,electricity_consumed:l,electricity_units:i.target.value,amount_collected:y+t.balance})}else if(i.target.name=="recurring_charges"){let l=(isNaN(d)?0:d)+a.rent+a.electricity_consumed*parseInt(t.electricity_unit_rate);h({...a,total:l,recurring_charges:d,amount_collected:l+t.balance,balance:a.amount_collected-a.total})}else if(i.target.name=="rent"){let l=a.recurring_charges+(isNaN(d)?0:d)+a.electricity_consumed*parseInt(t.electricity_unit_rate);h({...a,total:l,rent:d,amount_collected:l+t.balance,balance:l-l+t.balance})}else i.target.name=="amount_collected"?h({...a,amount_collected:d,balance:a.total+t.balance-d}):h(i.target.name,i.target.type==="checkbox"?i.target.checked:i.target.value)},k=i=>{i.preventDefault(),console.log(a),_(route("rooms.transaction.store",t.id))},T=()=>{b(!0)};return s(x,{children:[e(O,{heading:"Success!",message:"Electricity Meter Reset Successfully!",showNotification:g,setShowNotification:v}),e(G,{setShowNotification:v,room:t,setRoomData:h,setRoom:o,roomData:a,setElectricityModal:b,electricityModal:f}),e("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg px-4 py-4",children:s("form",{onSubmit:k,children:[e("div",{className:"flex flex-row justify-between items-start",children:e("h3",{className:"mb-4",children:r=="ADVANCE"?"Assign Tenant with Advanced Rent":s(x,{children:["Submit"," ",e("strong",{children:t.next_month.month})," ","Rent"]})})}),r=="ADVANCE"&&s(x,{children:[s("div",{className:"mb-4 flex ",children:[e("div",{className:"mr-1 md:w-full",children:e(u,{type:"text",required:!0,label:"Name",name:"name",InputClass:"w-full",value:a.name,onHandleChange:m,errors:c})}),e("div",{className:"ml-1 md:w-full",children:e(u,{type:"text",required:!0,label:"Phone Number",InputClass:"w-full",name:"phone",value:a.phone,onHandleChange:m,errors:c})})]}),s("div",{className:"mb-4 flex ",children:[e("div",{className:"mr-1 md:w-full",children:e(u,{type:"email",required:!0,label:"Email",InputClass:"w-full",name:"email",value:a.email,onHandleChange:m,errors:c})}),e("div",{className:"ml-1 md:w-full ",children:e(u,{type:"date",required:!0,label:"Rental Date",InputClass:"w-full",name:"date",value:a.date,onHandleChange:m,errors:c})})]})]}),e("div",{className:"flex flex-row items-center justify-between mb-4",children:e(u,{type:"number",min:t.initial_electricity_units,required:!0,label:r=="ADVANCE"?s(x,{children:["Starting Electricity Units In Meter :"," ",e("br",{}),e("span",{onClick:()=>T(),className:"text-blue-500 cursor-pointer",children:"Reset"})]}):"Electricity Units In Meter",InputClass:"mt-1 block w-32 md:w-3/4 text-base",name:"electricity_units",value:a.electricity_units,onHandleChange:m,errors:c})}),e("div",{className:"flex flex-row items-center justify-between mb-4",children:e(u,{type:"number",required:!0,label:"Electricity Consumed:",disabled:!0,InputClass:"mt-1 block w-32 md:w-3/4 text-base bg-gray-200",name:"electricity_consumed",value:a.electricity_consumed,onHandleChange:m,errors:c})}),e("div",{className:"flex flex-row items-center justify-between mb-4",children:e(u,{type:"number",required:!0,label:"Recurring Charges:",InputClass:"mt-1 block w-32 md:w-3/4 text-base",name:"recurring_charges",value:a.recurring_charges,onHandleChange:m,errors:c})}),e("div",{className:"flex flex-row items-center justify-between mb-4",children:e(u,{type:"number",required:!0,label:"Basic Rent:",InputClass:"mt-1 block w-32 md:w-3/4 text-base",name:"rent",value:a.rent,onHandleChange:m,errors:c})}),e("div",{children:s("h1",{className:"text-right flex justify-between uppercase",children:[e("span",{children:"Total Rent:"})," ",s("span",{className:"font-extrabold",children:["\u20B9",a.total]})]})}),e("div",{className:"flex flex-row items-center justify-between mt-4 mb-4",children:e(u,{type:"number",disabled:!0,label:"Balance Amount",InputClass:`mt-1 block w-32 md:w-3/4 text-base ${a.balance>0&&"bg-red-100"} ${a.balance<0&&"bg-green-100"} ${a.balance==0&&"bg-gray-200"}`,name:"balance",value:a.balance,onHandleChange:m,errors:c})}),e("div",{className:"flex flex-row items-center justify-between mt-4 mb-4",children:e(u,{type:"number",required:!0,label:"Amount to be Collected:",InputClass:"mt-1 block w-32 md:w-3/4 text-base",name:"amount_collected",value:a.amount_collected,onHandleChange:m,errors:c})}),e("div",{className:"mt-4",children:e(u,{type:"text",label:"Remark (optional):",InputClass:"w-full",name:"remark",value:a.remark,onHandleChange:m,errors:c})}),e("div",{className:"mt-4",children:e(S,{processing:w,children:"SUBMIT"})})]})})]})}function te(n){const{room:r,vacant:t}=n,o=()=>t==!0?e(A,{room:r,type:"VACANT"}):r.tenant?e(A,{room:r,type:"REGULAR"}):e(A,{room:r,type:"ADVANCE"});return s(M,{auth:n.auth,errors:n.errors,header:e(B,{back:route("property.rooms.index",r.property_id),title:t?"Vacant":r.tenant?"Submit Rent":"Assign Tenant"}),children:[e(V,{title:t?"Vacant":r.tenant?"Submit Rent":"Assign Tenant"}),e("div",{className:"py-1",children:e("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 sm:py-6 lg:py-8",children:e(o,{})})})]})}export{te as default};
